(()=>{var e=document.currentScript;define("72d496c1-9c6d-4880-85c1-8fd52ef320fb_0.0.1",["@microsoft/sp-core-library","@microsoft/sp-property-pane","@microsoft/sp-webpart-base","@microsoft/sp-lodash-subset","HelloWorldWebPartStrings"],(t,n,a,i,r)=>(()=>{"use strict";var o,s={371:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a,i,r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};!function(e){e[e.sync=0]="sync",e[e.async=1]="async"}(a||(a={})),function(e){e[e.onlyThemable=1]="onlyThemable",e[e.onlyNonThemable=2]="onlyNonThemable",e[e.all=3]="all"}(i||(i={}));var o,s,c,d="undefined"==typeof window?n.g:window,l=d&&d.CSPSettings&&d.CSPSettings.nonce,u=((c=d.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(c=r(r({},c),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:a.sync,buffer:[]}})),c.registeredThemableStyles||(c=r(r({},c),{registeredThemableStyles:[]})),d.__themeState__=c,c),f=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,p=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function m(e){var t=p();e();var n=p();u.perf.duration+=n-t}function _(e,t){u.loadStyles?u.loadStyles(h(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=h(e),i=a.styleString,r=a.themable;n.setAttribute("data-load-themed-styles","true"),l&&n.setAttribute("nonce",l),n.appendChild(document.createTextNode(i)),u.perf.count++,t.appendChild(n);var o=document.createEvent("HTMLEvents");o.initEvent("styleinsert",!0,!1),o.args={newStyle:n},document.dispatchEvent(o);var s={styleElement:n,themableStyle:e};r?u.registeredThemableStyles.push(s):u.registeredStyles.push(s)}}(e)}function h(e){var t=u.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}o='.helloWorld_0ccf8ff0{background:linear-gradient(135deg,#f5f7fa,#c3cfe2);color:"[theme:bodyText, default: #323130]";color:var(--bodyText);min-height:400px;overflow:hidden;padding:1.5em}.helloWorld_0ccf8ff0.teams_0ccf8ff0{font-family:Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif}.headerCard_0ccf8ff0{border-left:5px solid #0078d4;padding:2em}.headerCard_0ccf8ff0,.teamsCard_0ccf8ff0{background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);margin-bottom:1.5em}.teamsCard_0ccf8ff0{border-left:5px solid #6264a7;padding:1.5em}.teamsCard_0ccf8ff0 h3{color:#6264a7;margin-bottom:1em}.interactiveCard_0ccf8ff0{background:#fff;border-left:5px solid #16c60c;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);margin-bottom:1.5em;padding:1.5em}.interactiveCard_0ccf8ff0 h3{color:#16c60c;margin-bottom:1em}.contentCard_0ccf8ff0{background:#fff;border-left:5px solid #605e5c;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);padding:1.5em}.contentCard_0ccf8ff0 h3{color:#605e5c;margin-bottom:1em}.welcome_0ccf8ff0{text-align:center}.welcome_0ccf8ff0 h2{color:#0078d4;font-size:1.8em;margin:1em 0 .5em}.welcomeImage_0ccf8ff0{border-radius:8px;max-width:300px;width:100%}.environmentInfo_0ccf8ff0{background:#f3f9fd;border-radius:6px;color:#106ebe;font-weight:500;margin:1em 0;padding:.8em}.propertyInfo_0ccf8ff0{background:#fff4ce;border-radius:6px;color:#8a6914;margin:1em 0;padding:.8em}.counterSection_0ccf8ff0{text-align:center}.counterSection_0ccf8ff0 p{font-size:1.2em;margin-bottom:1em}.counterDisplay_0ccf8ff0{background:#16c60c;border-radius:20px;color:#fff;font-size:1.1em;font-weight:700;padding:.3em .8em}.primaryButton_0ccf8ff0{background:#0078d4;border:none;border-radius:6px;color:#fff;cursor:pointer;font-weight:500;margin:0 .5em;padding:.8em 1.5em;transition:all .2s ease}.primaryButton_0ccf8ff0:hover{background:#106ebe;box-shadow:0 4px 8px rgba(0,120,212,.3);transform:translateY(-1px)}.primaryButton_0ccf8ff0:active{transform:translateY(0)}.secondaryButton_0ccf8ff0{background:#f3f2f1;border:1px solid #d2d0ce;border-radius:6px;color:#323130;cursor:pointer;font-weight:500;margin:0 .5em;padding:.8em 1.5em;transition:all .2s ease}.secondaryButton_0ccf8ff0:hover{background:#edebe9;border-color:#c8c6c4;box-shadow:0 4px 8px rgba(0,0,0,.1);transform:translateY(-1px)}.secondaryButton_0ccf8ff0:active{transform:translateY(0)}.description_0ccf8ff0{color:#605e5c;font-size:1.05em;line-height:1.6;margin-bottom:1.5em}.links_0ccf8ff0{margin-top:1em}.links_0ccf8ff0 li{margin-bottom:.5em}.links_0ccf8ff0 li:hover{transform:translateX(5px);transition:transform .2s ease}.links_0ccf8ff0 a{color:"[theme:link, default:#03787c]";color:var(--link);display:inline-block;font-weight:500;padding:.3em 0;text-decoration:none}.links_0ccf8ff0 a:hover{color:"[theme:linkHovered, default: #014446]";color:var(--linkHovered);text-decoration:underline}.teamsSection_0ccf8ff0{min-height:200px}.loadingState_0ccf8ff0{color:#605e5c;padding:2em;text-align:center}.loadingState_0ccf8ff0 .spinner_0ccf8ff0{animation:spin_0ccf8ff0 1s linear infinite;border:3px solid #f3f2f1;border-radius:50%;border-top-color:#6264a7;height:32px;margin:0 auto 1em;width:32px}@keyframes spin_0ccf8ff0{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.errorState_0ccf8ff0{padding:2em;text-align:center}.errorState_0ccf8ff0 .errorMessage_0ccf8ff0{background:#fdf3f4;border-left:4px solid #d13438;border-radius:6px;color:#d13438;margin-bottom:1em;padding:1em}.emptyState_0ccf8ff0{padding:2em;text-align:center}.channelsList_0ccf8ff0{max-height:400px;overflow-y:auto}.teamGroup_0ccf8ff0{margin-bottom:1.5em}.teamName_0ccf8ff0{border-bottom:1px solid #e1dfdd;color:#6264a7;font-size:1.1em;margin:0 0 .8em;padding-bottom:.5em}.channelsGroup_0ccf8ff0{margin-left:1em}.channelItem_0ccf8ff0{align-items:center;border-radius:6px;cursor:pointer;display:flex;margin-bottom:.3em;padding:.6em;transition:background-color .2s ease}.channelItem_0ccf8ff0:hover{background:#f8f9fa}.channelItem_0ccf8ff0 input[type=checkbox]{accent-color:#6264a7;margin-right:.8em;transform:scale(1.2)}.channelItem_0ccf8ff0 .channelName_0ccf8ff0{color:#323130;font-weight:500;margin-right:.8em}.channelItem_0ccf8ff0 .channelDesc_0ccf8ff0{color:#605e5c;font-size:.9em;font-style:italic}.teamsHeader_0ccf8ff0{align-items:center;display:flex;justify-content:space-between;margin-bottom:1em}.teamsHeader_0ccf8ff0 h3{margin:0}.viewToggle_0ccf8ff0{display:flex;gap:.5em}.toggleButton_0ccf8ff0{background:#f3f2f1;border:1px solid #d2d0ce;border-radius:4px;color:#323130;cursor:pointer;font-size:.85em;padding:.5em 1em;transition:all .2s ease}.toggleButton_0ccf8ff0:hover{background:#edebe9;border-color:#c8c6c4}.toggleButton_0ccf8ff0.active_0ccf8ff0{background:#6264a7;border-color:#6264a7;color:#fff}.toggleButton_0ccf8ff0.active_0ccf8ff0:hover{background:#5a5da6}.treeContainer_0ccf8ff0{background:#fff;border:1px solid #e1dfdd;border-radius:6px;max-height:500px;overflow-y:auto}.treeItem_0ccf8ff0{border-bottom:1px solid #f8f9fa}.treeItem_0ccf8ff0:hover{background:#f8f9fa}.treeItem_0ccf8ff0:last-child{border-bottom:none}.treeItemContent_0ccf8ff0{align-items:center;display:flex;min-height:32px;padding:.4em .6em}.expandIcon_0ccf8ff0{color:#605e5c;cursor:pointer;font-size:.8em;margin-right:.5em;text-align:center;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:16px}.expandIcon_0ccf8ff0:hover{color:#323130}.itemIcon_0ccf8ff0{font-size:1em;margin-right:.5em;min-width:20px;text-align:center}.treeItemLabel_0ccf8ff0{align-items:center;cursor:pointer;display:flex;flex:1}.treeItemLabel_0ccf8ff0 input[type=checkbox]{accent-color:#6264a7;margin-right:.6em;transform:scale(1.1)}.treeItemLabel_0ccf8ff0 .itemName_0ccf8ff0{color:#323130;font-weight:500;margin-right:.6em}.treeItemLabel_0ccf8ff0 .itemDesc_0ccf8ff0{color:#605e5c;font-size:.85em;font-style:italic;margin-right:.6em}.treeItemLabel_0ccf8ff0 .loadingIcon_0ccf8ff0{animation:spin_0ccf8ff0 1s linear infinite;color:#6264a7;font-size:.9em}',void 0===(s=!0)&&(s=!1),m(function(){var e=Array.isArray(o)?o:function(e){var t=[];if(e){for(var n=0,a=void 0;a=f.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=f.lastIndex}t.push({rawString:e.substring(n)})}return t}(o),t=u.runState,n=t.mode,i=t.buffer,r=t.flushTimer;s||n===a.async?(i.push(e),r||(u.runState.flushTimer=self.setTimeout(function(){u.runState.flushTimer=0,m(function(){var e=u.runState.buffer.slice();u.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&_(t)})},0))):_(e)});const b={helloWorld_0ccf8ff0:"helloWorld_0ccf8ff0",teams_0ccf8ff0:"teams_0ccf8ff0",headerCard_0ccf8ff0:"headerCard_0ccf8ff0",teamsCard_0ccf8ff0:"teamsCard_0ccf8ff0",interactiveCard_0ccf8ff0:"interactiveCard_0ccf8ff0",contentCard_0ccf8ff0:"contentCard_0ccf8ff0",welcome_0ccf8ff0:"welcome_0ccf8ff0",welcomeImage_0ccf8ff0:"welcomeImage_0ccf8ff0",environmentInfo_0ccf8ff0:"environmentInfo_0ccf8ff0",propertyInfo_0ccf8ff0:"propertyInfo_0ccf8ff0",counterSection_0ccf8ff0:"counterSection_0ccf8ff0",counterDisplay_0ccf8ff0:"counterDisplay_0ccf8ff0",primaryButton_0ccf8ff0:"primaryButton_0ccf8ff0",secondaryButton_0ccf8ff0:"secondaryButton_0ccf8ff0",description_0ccf8ff0:"description_0ccf8ff0",links_0ccf8ff0:"links_0ccf8ff0",teamsSection_0ccf8ff0:"teamsSection_0ccf8ff0",loadingState_0ccf8ff0:"loadingState_0ccf8ff0",spinner_0ccf8ff0:"spinner_0ccf8ff0",spin_0ccf8ff0:"spin_0ccf8ff0",errorState_0ccf8ff0:"errorState_0ccf8ff0",errorMessage_0ccf8ff0:"errorMessage_0ccf8ff0",emptyState_0ccf8ff0:"emptyState_0ccf8ff0",channelsList_0ccf8ff0:"channelsList_0ccf8ff0",teamGroup_0ccf8ff0:"teamGroup_0ccf8ff0",teamName_0ccf8ff0:"teamName_0ccf8ff0",channelsGroup_0ccf8ff0:"channelsGroup_0ccf8ff0",channelItem_0ccf8ff0:"channelItem_0ccf8ff0",channelName_0ccf8ff0:"channelName_0ccf8ff0",channelDesc_0ccf8ff0:"channelDesc_0ccf8ff0",teamsHeader_0ccf8ff0:"teamsHeader_0ccf8ff0",viewToggle_0ccf8ff0:"viewToggle_0ccf8ff0",toggleButton_0ccf8ff0:"toggleButton_0ccf8ff0",active_0ccf8ff0:"active_0ccf8ff0",treeContainer_0ccf8ff0:"treeContainer_0ccf8ff0",treeItem_0ccf8ff0:"treeItem_0ccf8ff0",treeItemContent_0ccf8ff0:"treeItemContent_0ccf8ff0",expandIcon_0ccf8ff0:"expandIcon_0ccf8ff0",itemIcon_0ccf8ff0:"itemIcon_0ccf8ff0",treeItemLabel_0ccf8ff0:"treeItemLabel_0ccf8ff0",itemName_0ccf8ff0:"itemName_0ccf8ff0",itemDesc_0ccf8ff0:"itemDesc_0ccf8ff0",loadingIcon_0ccf8ff0:"loadingIcon_0ccf8ff0"}}
,309:(e,t,n)=>{e.exports=n.p+"welcome-dark_bc81978d2f17e05985ee.png"}
,141:(e,t,n)=>{e.exports=n.p+"welcome-light_a2dcb0d64c8d6e80cf49.png"}
,676:e=>{e.exports=t},529:e=>{e.exports=i},877:e=>{e.exports=n},642:e=>{e.exports=a},275:e=>{e.exports=r}},c={};function d(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={exports:{}};return s[e](n,n.exports,d),n.exports}d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o=e?e.src:"",d.p=o.slice(0,o.lastIndexOf("/")+1);var l={};return(()=>{d.r(l),d.d(l,{default:()=>_});var e=d(676),t=d(877),n=d(642),a=d(529);d(371);const i="counterDisplay_0ccf8ff0",r="primaryButton_0ccf8ff0";var o,s=d(275),c=function(){return c=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c.apply(this,arguments)},u=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},f=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},p=function(){function e(e){this.graphClient=e}return e.prototype.getUserTeams=function(){return u(this,void 0,void 0,function(){var e,t;return f(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.graphClient.api("/me/joinedTeams").get()];case 1:if(!(e=n.sent())||!e.value)throw new Error("No teams data received");return[2,e.value.map(function(e){return{id:e.id,displayName:e.displayName,description:e.description}})];case 2:throw t=n.sent(),this._handleError(t);case 3:return[2]}})})},e.prototype.getTeamChannels=function(e){return u(this,void 0,void 0,function(){var t,n;return f(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.graphClient.api("/teams/".concat(e,"/channels")).get()];case 1:if(!(t=a.sent())||!t.value)throw new Error("No channels data received");return[2,t.value.map(function(e){return{id:e.id,displayName:e.displayName,description:e.description}})];case 2:throw n=a.sent(),this._handleError(n);case 3:return[2]}})})},e.prototype.getAllChannelsForUser=function(){return u(this,void 0,void 0,function(){var e,t,n,a,i,r,o,s;return f(this,function(d){switch(d.label){case 0:return d.trys.push([0,6,,7]),[4,this.getUserTeams()];case 1:if(0===(e=d.sent()).length)throw{type:"NO_TEAMS",message:"User is not a member of any teams"};t=[],n=function(e){var n,i,r;return f(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,a.getTeamChannels(e.id)];case 1:return n=o.sent(),i=n.map(function(t){return c(c({},t),{teamId:e.id,teamName:e.displayName})}),t.push.apply(t,i),[3,3];case 2:return r=o.sent(),console.warn("Failed to get channels for team ".concat(e.displayName,":"),r),[3,3];case 3:return[2]}})},a=this,i=0,r=e,d.label=2;case 2:return i<r.length?(o=r[i],[5,n(o)]):[3,5];case 3:d.sent(),d.label=4;case 4:return i++,[3,2];case 5:return[2,t];case 6:if((s=d.sent()).type)throw s;throw this._handleError(s);case 7:return[2]}})})},e.prototype.getChannelFilesFolder=function(e,t){return u(this,void 0,void 0,function(){var n,a;return f(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.graphClient.api("/teams/".concat(e,"/channels/").concat(t,"/filesFolder")).get()];case 1:return n=i.sent(),console.log("Raw filesFolder response:",JSON.stringify(n,null,2)),[2,{id:n.id,name:n.name,webUrl:n.webUrl,size:n.size,folder:n.folder,createdDateTime:n.createdDateTime,lastModifiedDateTime:n.lastModifiedDateTime}];case 2:throw a=i.sent(),this._handleError(a);case 3:return[2]}})})},e.prototype.getDriveItemChildren=function(e,t){return void 0===t&&(t="root"),u(this,void 0,void 0,function(){var n,a;return f(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.graphClient.api("/drives/".concat(e,"/items/").concat(t,"/children")).get()];case 1:return(n=i.sent())&&n.value?[2,n.value.map(function(e){return{id:e.id,name:e.name,webUrl:e.webUrl,size:e.size,folder:e.folder,file:e.file,createdDateTime:e.createdDateTime,lastModifiedDateTime:e.lastModifiedDateTime}})]:[2,[]];case 2:return a=i.sent(),console.warn("Failed to get drive item children:",a),[2,[]];case 3:return[2]}})})},e.prototype.buildTeamsTreeView=function(){return u(this,void 0,void 0,function(){var e,t,n,a,i,r,o,s,c,d,l,u,p;return f(this,function(f){switch(f.label){case 0:return f.trys.push([0,9,,10]),[4,this.getUserTeams()];case 1:e=f.sent(),t=[],n=0,a=e,f.label=2;case 2:if(!(n<a.length))return[3,8];i=a[n],r={id:i.id,name:i.displayName,type:"team",description:i.description,isExpanded:!1,children:[]},f.label=3;case 3:return f.trys.push([3,5,,6]),[4,this.getTeamChannels(i.id)];case 4:for(o=f.sent(),s=0,c=o;s<c.length;s++)d=c[s],l={id:"".concat(i.id,"_").concat(d.id),name:d.displayName,type:"channel",description:d.description,parentId:i.id,teamId:i.id,channelId:d.id,isExpanded:!1,children:[],childCount:0,isLoading:!1},r.children&&r.children.push(l);return[3,6];case 5:return u=f.sent(),console.warn("Failed to get channels for team ".concat(i.displayName,":"),u),[3,6];case 6:t.push(r),f.label=7;case 7:return n++,[3,2];case 8:return[2,t];case 9:throw p=f.sent(),this._handleError(p);case 10:return[2]}})})},e.prototype.loadChannelFiles=function(e,t){return u(this,void 0,void 0,function(){var n,a,i,r,o,s,c,d,l,u,p;return f(this,function(f){switch(f.label){case 0:return f.trys.push([0,13,,14]),[4,this.getChannelFilesFolder(e,t)];case 1:return n=f.sent(),console.log("FilesFolder response:",n),n.webUrl?[4,this.graphClient.api("/groups/".concat(e,"/drive")).get()]:(console.warn("No webUrl in filesFolder response"),[2,[]]);case 2:return(a=f.sent())?(console.log("Drive response:",a),[4,this.getDriveItemChildren(a.id,"root")]):(console.warn("No drive response for team"),[2,[]]);case 3:i=f.sent(),console.log("Root items:",i),r=[],o=0,s=i,f.label=4;case 4:return o<s.length?(c=s[o]).folder?[4,this.getDriveItemChildren(a.id,c.id)]:[3,6]:[3,7];case 5:d=f.sent(),console.log("Contents of ".concat(c.name,":"),d),r=r.concat(d),f.label=6;case 6:return o++,[3,4];case 7:if(0!==r.length)return[3,12];f.label=8;case 8:return f.trys.push([8,11,,12]),(l=n).parentReference&&l.parentReference.driveId?[4,this.getDriveItemChildren(l.parentReference.driveId,l.id)]:[3,10];case 9:r=f.sent(),f.label=10;case 10:return[3,12];case 11:return u=f.sent(),console.warn("Fallback method failed:",u),[3,12];case 12:return[2,this._convertDriveItemsToTreeNodes(r,a.id,"".concat(e,"_").concat(t))];case 13:return p=f.sent(),console.error("Failed to load files for channel ".concat(t,":"),p),[2,[]];case 14:return[2]}})})},e.prototype.loadChannelFilesDirect=function(e,t){return u(this,void 0,void 0,function(){var n,a,i,r;return f(this,function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),console.log("üîç Starting loadChannelFilesDirect for teamId: ".concat(e,", channelId: ").concat(t)),[4,this.getChannelFilesFolder(e,t)];case 1:return n=o.sent(),console.log("üìÅ FilesFolder data:",JSON.stringify(n,null,2)),n.id?[4,this.graphClient.api("/teams/".concat(e,"/channels/").concat(t,"/filesFolder")).select("id,name,parentReference,webUrl").get()]:[3,4];case 2:return a=o.sent(),console.log("üîß Full filesFolder response:",JSON.stringify(a,null,2)),a.parentReference&&a.parentReference.driveId?(console.log("üìÇ Found drive ID: ".concat(a.parentReference.driveId,", item ID: ").concat(a.id)),[4,this.getDriveItemChildren(a.parentReference.driveId,a.id)]):[3,4];case 3:if(i=o.sent(),console.log("üìÑ Found ".concat(i.length," items in channel folder")),i.length>0)return console.log("‚úÖ Successfully loaded files:",i.map(function(e){return e.name})),[2,this._convertDriveItemsToTreeNodes(i,a.parentReference.driveId,"".concat(e,"_").concat(t))];o.label=4;case 4:return console.log("‚ö†Ô∏è No files found or no drive reference available"),[2,[]];case 5:return r=o.sent(),console.error("‚ùå Direct approach failed for channel ".concat(t,":"),r),console.error("Error details:",JSON.stringify(r,null,2)),[2,[]];case 6:return[2]}})})},e.prototype._convertDriveItemsToTreeNodes=function(e,t,n){return e.map(function(e){var a;return{id:"".concat(n,"_").concat(e.id),name:e.name,type:e.folder?"folder":"file",parentId:n,webUrl:e.webUrl,size:e.size,driveId:t,itemId:e.id,childCount:(null===(a=e.folder)||void 0===a?void 0:a.childCount)||0,isExpanded:!1,children:[],isLoading:!1}})},e.prototype._handleError=function(e){return console.error("Teams Service Error:",e),"Forbidden"===e.code||403===e.status?{type:"NO_PERMISSIONS",message:"Insufficient permissions to access Teams data. Please contact your administrator.",originalError:e}:"NetworkError"===e.code||"NetworkError"===e.name?{type:"NETWORK_ERROR",message:"Network error occurred while fetching Teams data. Please check your connection and try again.",originalError:e}:{type:"UNKNOWN",message:"An unexpected error occurred: ".concat(e.message||"Unknown error"),originalError:e}},e}(),m=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});const _=function(n){function o(){var e=null!==n&&n.apply(this,arguments)||this;return e._isDarkTheme=!1,e._environmentMessage="",e._clickCount=0,e._teamsService=null,e._channels=[],e._selectedChannels=new Set,e._isLoading=!1,e._error="",e}return m(o,n),o.prototype.render=function(){this.domElement.innerHTML='\n    <section class="'.concat("helloWorld_0ccf8ff0"," ").concat(this.context.sdks.microsoftTeams?"teams_0ccf8ff0":"",'">\n      <div class="').concat("headerCard_0ccf8ff0",'">\n        <div class="').concat("welcome_0ccf8ff0",'">\n          <img alt="" src="').concat(this._isDarkTheme?d(309):d(141),'" class="').concat("welcomeImage_0ccf8ff0",'" />\n          <h2>Well done, ').concat((0,a.escape)(this.context.pageContext.user.displayName),'!</h2>\n          <div class="').concat("environmentInfo_0ccf8ff0",'">').concat(this._environmentMessage,'</div>\n          <div class="').concat("propertyInfo_0ccf8ff0",'">Web part property: <strong>').concat((0,a.escape)(this.properties.description),'</strong></div>\n        </div>\n      </div>\n\n      <div class="').concat("teamsCard_0ccf8ff0",'">\n        <h3>üìã My Teams Channels</h3>\n        <div class="').concat("teamsSection_0ccf8ff0",'">\n          ').concat(this._renderTeamsContent(),'\n        </div>\n      </div>\n\n      <div class="').concat("interactiveCard_0ccf8ff0",'">\n        <h3>üéØ Interactive Test Area</h3>\n        <div class="').concat("counterSection_0ccf8ff0",'">\n          <p>Click counter: <span class="').concat(i,'">').concat(this._clickCount,'</span></p>\n          <button class="').concat(r,'" data-action="increment">Increment Counter</button>\n          <button class="').concat("secondaryButton_0ccf8ff0",'" data-action="reset">Reset Counter</button>\n        </div>\n      </div>\n\n      <div class="').concat("contentCard_0ccf8ff0",'">\n        <h3>üìö Welcome to SharePoint Framework!</h3>\n        <p class="').concat("description_0ccf8ff0",'">\n        The SharePoint Framework (SPFx) is an extensibility model for Microsoft Viva, Microsoft Teams and SharePoint. It\'s the easiest way to extend Microsoft 365 with automatic Single Sign On, automatic hosting and industry standard tooling.\n        </p>\n        <h4>üöÄ Learn more about SPFx development:</h4>\n          <ul class="').concat("links_0ccf8ff0",'">\n            <li><a href="https://aka.ms/spfx" target="_blank">üìñ SharePoint Framework Overview</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-graph" target="_blank">üìä Use Microsoft Graph in your solution</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-teams" target="_blank">üë• Build for Microsoft Teams using SharePoint Framework</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-viva" target="_blank">üíº Build for Microsoft Viva Connections using SharePoint Framework</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-store" target="_blank">üè™ Publish SharePoint Framework applications to the marketplace</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-api" target="_blank">üîß SharePoint Framework API reference</a></li>\n            <li><a href="https://aka.ms/m365pnp" target="_blank">ÔøΩü§ù Microsoft 365 Developer Community</a></li>\n          </ul>\n      </div>\n    </section>'),this._bindEvents()},o.prototype._renderTeamsContent=function(){if(this._isLoading)return'\n        <div class="'.concat("loadingState_0ccf8ff0",'">\n          <div class="').concat("spinner_0ccf8ff0",'"></div>\n          <p>Loading Teams channels...</p>\n        </div>\n      ');if(this._error)return'\n        <div class="'.concat("errorState_0ccf8ff0",'">\n          <p class="').concat("errorMessage_0ccf8ff0",'">‚ùå ').concat(this._error,'</p>\n          <button class="').concat(r,'" data-action="retry">Try Again</button>\n        </div>\n      ');if(0===this._channels.length)return'\n        <div class="'.concat("emptyState_0ccf8ff0",'">\n          <button class="').concat(r,'" data-action="load-channels">Load My Teams Channels</button>\n        </div>\n      ');for(var e=this._groupChannelsByTeam(),t='<div class="${styles.channelsList}">',n=Object.keys(e),i=0;i<n.length;i++){var o=n[i],s=e[o];t+='\n        <div class="'.concat("teamGroup_0ccf8ff0",'">\n          <h4 class="').concat("teamName_0ccf8ff0",'">üë• ').concat((0,a.escape)(o),'</h4>\n          <div class="').concat("channelsGroup_0ccf8ff0",'">\n      ');for(var c=0;c<s.length;c++){var d=s[c],l=this._selectedChannels.has(d.id);t+='\n          <label class="'.concat("channelItem_0ccf8ff0",'">\n            <input type="checkbox"\n                   data-channel-id="').concat(d.id,'"\n                   ').concat(l?"checked":"",' />\n            <span class="').concat("channelName_0ccf8ff0",'"># ').concat((0,a.escape)(d.displayName),"</span>\n            ").concat(d.description?'<span class="'.concat("channelDesc_0ccf8ff0",'">').concat((0,a.escape)(d.description),"</span>"):"","\n          </label>\n        ")}t+="\n          </div>\n        </div>\n      "}return t+"</div>"},o.prototype._groupChannelsByTeam=function(){return this._channels.reduce(function(e,t){var n=t.teamName;return e[n]||(e[n]=[]),e[n].push(t),e},{})},o.prototype._bindEvents=function(){var e=this;this.domElement.addEventListener("click",function(t){var n=t.target.getAttribute("data-action");"increment"===n?(e._clickCount++,e._updateCounter()):"reset"===n?(e._clickCount=0,e._updateCounter()):"load-channels"===n?e._loadTeamsChannels():"retry"===n&&(e._error="",e._loadTeamsChannels())}),this.domElement.addEventListener("change",function(t){var n=t.target;"checkbox"===n.type&&n.dataset.channelId&&e._handleChannelSelection(n.dataset.channelId,n.checked)})},o.prototype._updateCounter=function(){var e=this.domElement.querySelector(".".concat(i));e&&(e.textContent=this._clickCount.toString())},o.prototype._loadTeamsChannels=function(){return e=this,n=function(){var e,t,n,a;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(i){switch(i.label){case 0:this._isLoading=!0,this._error="",this.render(),i.label=1;case 1:return i.trys.push([1,5,,6]),this._teamsService?[3,3]:[4,this.context.msGraphClientFactory.getClient("3")];case 2:e=i.sent(),this._teamsService=new p(e),i.label=3;case 3:return t=this,[4,this._teamsService.getAllChannelsForUser()];case 4:return t._channels=i.sent(),this._isLoading=!1,this.render(),[3,6];case 5:switch(n=i.sent(),this._isLoading=!1,(a=n).type){case"NO_PERMISSIONS":this._error="Insufficient permissions. Please contact your administrator to approve Microsoft Graph permissions.";break;case"NO_TEAMS":this._error="You are not a member of any teams.";break;case"NETWORK_ERROR":this._error="Network error. Please check your connection and try again.";break;default:this._error=a.message||"An unexpected error occurred while loading channels."}return this.render(),console.error("Error loading Teams channels:",n),[3,6];case 6:return[2]}})},new((t=void 0)||(t=Promise))(function(a,i){function r(e){try{s(n.next(e))}catch(e){i(e)}}function o(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(r,o)}s((n=n.apply(e,[])).next())});var e,t,n},o.prototype._handleChannelSelection=function(e,t){t?this._selectedChannels.add(e):this._selectedChannels.delete(e);var n=[];this._selectedChannels.forEach(function(e){return n.push(e)}),console.log("Selected channels:",n)},o.prototype.onInit=function(){var e=this;return this._getEnvironmentMessage().then(function(t){e._environmentMessage=t})},o.prototype._getEnvironmentMessage=function(){var e=this;return this.context.sdks.microsoftTeams?this.context.sdks.microsoftTeams.teamsJs.app.getContext().then(function(t){var n="";switch(t.app.host.name){case"Office":n=e.context.isServedFromLocalhost?s.AppLocalEnvironmentOffice:s.AppOfficeEnvironment;break;case"Outlook":n=e.context.isServedFromLocalhost?s.AppLocalEnvironmentOutlook:s.AppOutlookEnvironment;break;case"Teams":case"TeamsModern":n=e.context.isServedFromLocalhost?s.AppLocalEnvironmentTeams:s.AppTeamsTabEnvironment;break;default:n=s.UnknownEnvironment}return n}):Promise.resolve(this.context.isServedFromLocalhost?s.AppLocalEnvironmentSharePoint:s.AppSharePointEnvironment)},o.prototype.onThemeChanged=function(e){if(e){this._isDarkTheme=!!e.isInverted;var t=e.semanticColors;t&&(this.domElement.style.setProperty("--bodyText",t.bodyText||null),this.domElement.style.setProperty("--link",t.link||null),this.domElement.style.setProperty("--linkHovered",t.linkHovered||null))}},Object.defineProperty(o.prototype,"dataVersion",{get:function(){return e.Version.parse("1.0")},enumerable:!1,configurable:!0}),o.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:s.PropertyPaneDescription},groups:[{groupName:s.BasicGroupName,groupFields:[(0,t.PropertyPaneTextField)("description",{label:s.DescriptionFieldLabel})]}]}]}},o}(n.BaseClientSideWebPart)})(),l})())})();