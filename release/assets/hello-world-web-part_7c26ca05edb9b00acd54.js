(()=>{var e=document.currentScript;define("72d496c1-9c6d-4880-85c1-8fd52ef320fb_0.0.1",["@microsoft/sp-core-library","@microsoft/sp-property-pane","@microsoft/sp-webpart-base","@microsoft/sp-lodash-subset","HelloWorldWebPartStrings"],(t,n,a,i,r)=>(()=>{"use strict";var o,s={371:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a,i,r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};!function(e){e[e.sync=0]="sync",e[e.async=1]="async"}(a||(a={})),function(e){e[e.onlyThemable=1]="onlyThemable",e[e.onlyNonThemable=2]="onlyNonThemable",e[e.all=3]="all"}(i||(i={}));var o,s,c,d="undefined"==typeof window?n.g:window,l=d&&d.CSPSettings&&d.CSPSettings.nonce,u=((c=d.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(c=r(r({},c),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:a.sync,buffer:[]}})),c.registeredThemableStyles||(c=r(r({},c),{registeredThemableStyles:[]})),d.__themeState__=c,c),f=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,p=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function m(e){var t=p();e();var n=p();u.perf.duration+=n-t}function _(e,t){u.loadStyles?u.loadStyles(h(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=h(e),i=a.styleString,r=a.themable;n.setAttribute("data-load-themed-styles","true"),l&&n.setAttribute("nonce",l),n.appendChild(document.createTextNode(i)),u.perf.count++,t.appendChild(n);var o=document.createEvent("HTMLEvents");o.initEvent("styleinsert",!0,!1),o.args={newStyle:n},document.dispatchEvent(o);var s={styleElement:n,themableStyle:e};r?u.registeredThemableStyles.push(s):u.registeredStyles.push(s)}}(e)}function h(e){var t=u.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}o='.helloWorld_044e9f46{background:linear-gradient(135deg,#f5f7fa,#c3cfe2);color:"[theme:bodyText, default: #323130]";color:var(--bodyText);min-height:400px;overflow:hidden;padding:1.5em}.helloWorld_044e9f46.teams_044e9f46{font-family:Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif}.headerCard_044e9f46{border-left:5px solid #0078d4;padding:2em}.headerCard_044e9f46,.teamsCard_044e9f46{background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);margin-bottom:1.5em}.teamsCard_044e9f46{border-left:5px solid #6264a7;padding:1.5em}.teamsCard_044e9f46 h3{color:#6264a7;margin-bottom:1em}.interactiveCard_044e9f46{background:#fff;border-left:5px solid #16c60c;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);margin-bottom:1.5em;padding:1.5em}.interactiveCard_044e9f46 h3{color:#16c60c;margin-bottom:1em}.contentCard_044e9f46{background:#fff;border-left:5px solid #605e5c;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);padding:1.5em}.contentCard_044e9f46 h3{color:#605e5c;margin-bottom:1em}.welcome_044e9f46{text-align:center}.welcome_044e9f46 h2{color:#0078d4;font-size:1.8em;margin:1em 0 .5em}.welcomeImage_044e9f46{border-radius:8px;max-width:300px;width:100%}.environmentInfo_044e9f46{background:#f3f9fd;border-radius:6px;color:#106ebe;font-weight:500;margin:1em 0;padding:.8em}.propertyInfo_044e9f46{background:#fff4ce;border-radius:6px;color:#8a6914;margin:1em 0;padding:.8em}.counterSection_044e9f46{text-align:center}.counterSection_044e9f46 p{font-size:1.2em;margin-bottom:1em}.counterDisplay_044e9f46{background:#16c60c;border-radius:20px;color:#fff;font-size:1.1em;font-weight:700;padding:.3em .8em}.primaryButton_044e9f46{background:#0078d4;border:none;border-radius:6px;color:#fff;cursor:pointer;font-weight:500;margin:0 .5em;padding:.8em 1.5em;transition:all .2s ease}.primaryButton_044e9f46:hover{background:#106ebe;box-shadow:0 4px 8px rgba(0,120,212,.3);transform:translateY(-1px)}.primaryButton_044e9f46:active{transform:translateY(0)}.secondaryButton_044e9f46{background:#f3f2f1;border:1px solid #d2d0ce;border-radius:6px;color:#323130;cursor:pointer;font-weight:500;margin:0 .5em;padding:.8em 1.5em;transition:all .2s ease}.secondaryButton_044e9f46:hover{background:#edebe9;border-color:#c8c6c4;box-shadow:0 4px 8px rgba(0,0,0,.1);transform:translateY(-1px)}.secondaryButton_044e9f46:active{transform:translateY(0)}.description_044e9f46{color:#605e5c;font-size:1.05em;line-height:1.6;margin-bottom:1.5em}.links_044e9f46{margin-top:1em}.links_044e9f46 li{margin-bottom:.5em}.links_044e9f46 li:hover{transform:translateX(5px);transition:transform .2s ease}.links_044e9f46 a{color:"[theme:link, default:#03787c]";color:var(--link);display:inline-block;font-weight:500;padding:.3em 0;text-decoration:none}.links_044e9f46 a:hover{color:"[theme:linkHovered, default: #014446]";color:var(--linkHovered);text-decoration:underline}.teamsSection_044e9f46{min-height:200px}.loadingState_044e9f46{color:#605e5c;padding:2em;text-align:center}.loadingState_044e9f46 .spinner_044e9f46{animation:spin_044e9f46 1s linear infinite;border:3px solid #f3f2f1;border-radius:50%;border-top-color:#6264a7;height:32px;margin:0 auto 1em;width:32px}@keyframes spin_044e9f46{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.errorState_044e9f46{padding:2em;text-align:center}.errorState_044e9f46 .errorMessage_044e9f46{background:#fdf3f4;border-left:4px solid #d13438;border-radius:6px;color:#d13438;margin-bottom:1em;padding:1em}.emptyState_044e9f46{padding:2em;text-align:center}.channelsList_044e9f46{max-height:400px;overflow-y:auto}.teamGroup_044e9f46{margin-bottom:1.5em}.teamName_044e9f46{border-bottom:1px solid #e1dfdd;color:#6264a7;font-size:1.1em;margin:0 0 .8em;padding-bottom:.5em}.channelsGroup_044e9f46{margin-left:1em}.channelContainer_044e9f46{margin-bottom:.3em}.channelItem_044e9f46{align-items:center;border-radius:6px;cursor:pointer;display:flex;padding:.6em;transition:background-color .2s ease}.channelItem_044e9f46:hover{background:#f8f9fa}.channelItem_044e9f46 input[type=checkbox]{accent-color:#6264a7;margin-right:.8em;transform:scale(1.2)}.channelItem_044e9f46 .channelName_044e9f46{color:#323130;font-weight:500;margin-right:.8em}.channelItem_044e9f46 .channelDesc_044e9f46{color:#605e5c;font-size:.9em;font-style:italic;margin-right:.8em}.showFilesBtn_044e9f46{cursor:pointer;font-size:1.1em;margin-left:auto;padding:.2em .5em}.showFilesBtn_044e9f46:hover{background:#e1dfdd;border-radius:4px}.filesList_044e9f46{background:#f8f9fa;border-left:3px solid #6264a7;border-radius:4px;margin-left:2em;margin-top:.5em;padding:.5em}.filesUL_044e9f46{list-style:none;margin:0;padding:0}.fileItem_044e9f46,.folderItem_044e9f46{align-items:center;color:#323130;display:flex;font-size:.9em;padding:.3em 0}.fileItem_044e9f46 input[type=checkbox],.folderItem_044e9f46 input[type=checkbox]{accent-color:#6264a7;margin-right:.5em;transform:scale(1.1)}.folderName_044e9f46{border-radius:3px;cursor:pointer;padding:.2em .4em}.folderName_044e9f46:hover{background:#e1dfdd}.subFolderContent_044e9f46{background:#f0f0f0;border-left:2px solid #6264a7;border-radius:4px;margin-left:1.5em;margin-top:.5em;padding:.5em}.subFilesContainer_044e9f46{margin:0;padding:0}.subFileItem_044e9f46{align-items:center;border-bottom:1px solid #e8e8e8;color:#323130;display:flex;font-size:.85em;padding:.4em 0}.subFileItem_044e9f46:last-child{border-bottom:none}.subFileItem_044e9f46 input[type=checkbox]{accent-color:#6264a7;margin-right:.5em;transform:scale(1.1)}.subFileItem_044e9f46 span{word-break:break-all}.teamsHeader_044e9f46{align-items:center;display:flex;justify-content:space-between;margin-bottom:1em}.teamsHeader_044e9f46 h3{margin:0}.viewToggle_044e9f46{display:flex;gap:.5em}.toggleButton_044e9f46{background:#f3f2f1;border:1px solid #d2d0ce;border-radius:4px;color:#323130;cursor:pointer;font-size:.85em;padding:.5em 1em;transition:all .2s ease}.toggleButton_044e9f46:hover{background:#edebe9;border-color:#c8c6c4}.toggleButton_044e9f46.active_044e9f46{background:#6264a7;border-color:#6264a7;color:#fff}.toggleButton_044e9f46.active_044e9f46:hover{background:#5a5da6}.treeContainer_044e9f46{background:#fff;border:1px solid #e1dfdd;border-radius:6px;max-height:500px;overflow-y:auto}.treeItem_044e9f46{border-bottom:1px solid #f8f9fa}.treeItem_044e9f46:hover{background:#f8f9fa}.treeItem_044e9f46:last-child{border-bottom:none}.treeItemContent_044e9f46{align-items:center;display:flex;min-height:32px;padding:.4em .6em}.expandIcon_044e9f46{color:#605e5c;cursor:pointer;font-size:.8em;margin-right:.5em;text-align:center;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:16px}.expandIcon_044e9f46:hover{color:#323130}.itemIcon_044e9f46{font-size:1em;margin-right:.5em;min-width:20px;text-align:center}.treeItemLabel_044e9f46{align-items:center;cursor:pointer;display:flex;flex:1}.treeItemLabel_044e9f46 input[type=checkbox]{accent-color:#6264a7;margin-right:.6em;transform:scale(1.1)}.treeItemLabel_044e9f46 .itemName_044e9f46{color:#323130;font-weight:500;margin-right:.6em}.treeItemLabel_044e9f46 .itemDesc_044e9f46{color:#605e5c;font-size:.85em;font-style:italic;margin-right:.6em}.treeItemLabel_044e9f46 .loadingIcon_044e9f46{animation:spin_044e9f46 1s linear infinite;color:#6264a7;font-size:.9em}.syncInterface_044e9f46 .syncHeader_044e9f46{margin-bottom:1.5em}.syncInterface_044e9f46 .syncHeader_044e9f46 .siteInfo_044e9f46{background:#f3f9fd;border-left:4px solid #0078d4;border-radius:6px;margin-bottom:1em;padding:1em}.syncInterface_044e9f46 .syncHeader_044e9f46 .siteInfo_044e9f46 p{color:#106ebe;margin:0}.syncInterface_044e9f46 .syncHeader_044e9f46 .siteInfo_044e9f46 p a{color:#0078d4;font-weight:500;text-decoration:none}.syncInterface_044e9f46 .syncHeader_044e9f46 .siteInfo_044e9f46 p a:hover{text-decoration:underline}.syncInterface_044e9f46 .syncHeader_044e9f46 .syncStatus_044e9f46{background:#f8f9fa;border-left:4px solid #6264a7;border-radius:6px;padding:1em}.syncInterface_044e9f46 .syncHeader_044e9f46 .syncStatus_044e9f46 p{color:#323130;font-size:.95em;margin:0 0 .5em}.syncInterface_044e9f46 .syncHeader_044e9f46 .syncStatus_044e9f46 p:last-child{margin-bottom:0}.syncInterface_044e9f46 .syncHeader_044e9f46 .syncStatus_044e9f46 p strong{color:#6264a7;font-weight:600}.syncInterface_044e9f46 .syncHeader_044e9f46 .syncStatus_044e9f46 .errorMessage_044e9f46{background:#fdf3f4;border:1px solid #f9c7ca;border-radius:4px;color:#d13438;font-size:.9em;margin-top:.5em;padding:.5em}.syncInterface_044e9f46 .syncControls_044e9f46{align-items:center;display:flex;flex-wrap:wrap;gap:1em;margin-bottom:1.5em}.syncInterface_044e9f46 .syncControls_044e9f46 button:disabled{cursor:not-allowed;opacity:.6}.syncInterface_044e9f46 .syncControls_044e9f46 button:disabled:hover{box-shadow:none;transform:none}.teamsListContainer_044e9f46 h4{color:#6264a7;font-size:1.1em;font-weight:600;margin:0 0 1em}.teamsList_044e9f46{background:#f8f9fa;border-left:4px solid #16c60c;border-radius:6px;padding:1em}.teamItem_044e9f46{align-items:center;border-bottom:1px solid #e1dfdd;display:flex;padding:.5em 0}.teamItem_044e9f46:last-child{border-bottom:none}.teamItem_044e9f46 .teamIcon_044e9f46{font-size:1.1em;margin-right:.8em}.teamItem_044e9f46 .teamName_044e9f46{color:#323130;flex:1;font-weight:500;margin-right:.8em}.teamItem_044e9f46 .fileCount_044e9f46{color:#605e5c;font-size:.9em;font-style:italic}',void 0===(s=!0)&&(s=!1),m(function(){var e=Array.isArray(o)?o:function(e){var t=[];if(e){for(var n=0,a=void 0;a=f.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=f.lastIndex}t.push({rawString:e.substring(n)})}return t}(o),t=u.runState,n=t.mode,i=t.buffer,r=t.flushTimer;s||n===a.async?(i.push(e),r||(u.runState.flushTimer=self.setTimeout(function(){u.runState.flushTimer=0,m(function(){var e=u.runState.buffer.slice();u.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&_(t)})},0))):_(e)});const b={helloWorld_044e9f46:"helloWorld_044e9f46",teams_044e9f46:"teams_044e9f46",headerCard_044e9f46:"headerCard_044e9f46",teamsCard_044e9f46:"teamsCard_044e9f46",interactiveCard_044e9f46:"interactiveCard_044e9f46",contentCard_044e9f46:"contentCard_044e9f46",welcome_044e9f46:"welcome_044e9f46",welcomeImage_044e9f46:"welcomeImage_044e9f46",environmentInfo_044e9f46:"environmentInfo_044e9f46",propertyInfo_044e9f46:"propertyInfo_044e9f46",counterSection_044e9f46:"counterSection_044e9f46",counterDisplay_044e9f46:"counterDisplay_044e9f46",primaryButton_044e9f46:"primaryButton_044e9f46",secondaryButton_044e9f46:"secondaryButton_044e9f46",description_044e9f46:"description_044e9f46",links_044e9f46:"links_044e9f46",teamsSection_044e9f46:"teamsSection_044e9f46",loadingState_044e9f46:"loadingState_044e9f46",spinner_044e9f46:"spinner_044e9f46",spin_044e9f46:"spin_044e9f46",errorState_044e9f46:"errorState_044e9f46",errorMessage_044e9f46:"errorMessage_044e9f46",emptyState_044e9f46:"emptyState_044e9f46",channelsList_044e9f46:"channelsList_044e9f46",teamGroup_044e9f46:"teamGroup_044e9f46",teamName_044e9f46:"teamName_044e9f46",channelsGroup_044e9f46:"channelsGroup_044e9f46",channelContainer_044e9f46:"channelContainer_044e9f46",channelItem_044e9f46:"channelItem_044e9f46",channelName_044e9f46:"channelName_044e9f46",channelDesc_044e9f46:"channelDesc_044e9f46",showFilesBtn_044e9f46:"showFilesBtn_044e9f46",filesList_044e9f46:"filesList_044e9f46",filesUL_044e9f46:"filesUL_044e9f46",fileItem_044e9f46:"fileItem_044e9f46",folderItem_044e9f46:"folderItem_044e9f46",folderName_044e9f46:"folderName_044e9f46",subFolderContent_044e9f46:"subFolderContent_044e9f46",subFilesContainer_044e9f46:"subFilesContainer_044e9f46",subFileItem_044e9f46:"subFileItem_044e9f46",teamsHeader_044e9f46:"teamsHeader_044e9f46",viewToggle_044e9f46:"viewToggle_044e9f46",toggleButton_044e9f46:"toggleButton_044e9f46",active_044e9f46:"active_044e9f46",treeContainer_044e9f46:"treeContainer_044e9f46",treeItem_044e9f46:"treeItem_044e9f46",treeItemContent_044e9f46:"treeItemContent_044e9f46",expandIcon_044e9f46:"expandIcon_044e9f46",itemIcon_044e9f46:"itemIcon_044e9f46",treeItemLabel_044e9f46:"treeItemLabel_044e9f46",itemName_044e9f46:"itemName_044e9f46",itemDesc_044e9f46:"itemDesc_044e9f46",loadingIcon_044e9f46:"loadingIcon_044e9f46",syncInterface_044e9f46:"syncInterface_044e9f46",syncHeader_044e9f46:"syncHeader_044e9f46",siteInfo_044e9f46:"siteInfo_044e9f46",syncStatus_044e9f46:"syncStatus_044e9f46",syncControls_044e9f46:"syncControls_044e9f46",teamsListContainer_044e9f46:"teamsListContainer_044e9f46",teamsList_044e9f46:"teamsList_044e9f46",teamItem_044e9f46:"teamItem_044e9f46",teamIcon_044e9f46:"teamIcon_044e9f46",fileCount_044e9f46:"fileCount_044e9f46"}}
,309:(e,t,n)=>{e.exports=n.p+"welcome-dark_bc81978d2f17e05985ee.png"}
,141:(e,t,n)=>{e.exports=n.p+"welcome-light_a2dcb0d64c8d6e80cf49.png"}
,676:e=>{e.exports=t},529:e=>{e.exports=i},877:e=>{e.exports=n},642:e=>{e.exports=a},275:e=>{e.exports=r}},c={};function d(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={exports:{}};return s[e](n,n.exports,d),n.exports}d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o=e?e.src:"",d.p=o.slice(0,o.lastIndexOf("/")+1);var l={};return(()=>{d.r(l),d.d(l,{default:()=>v});var e=d(676),t=d(877),n=d(642),a=d(529);d(371);const i="counterDisplay_044e9f46",r="primaryButton_044e9f46",o="secondaryButton_044e9f46",s="errorMessage_044e9f46";var c,u=d(275),f=function(){return f=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f.apply(this,arguments)},p=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},m=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_=function(){function e(e){this._userSite=null,this.graphClient=e,this._syncStatus={isEnabled:this._getSyncPreference(),fileCount:0,teamsCount:0,status:"idle"},this._loadSyncStatus()}return e.prototype.getUserGroupMemberships=function(){return p(this,void 0,void 0,function(){var e,t;return m(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.graphClient.api("/me/memberOf").select("id,displayName,description,resourceBehaviorOptions,resourceProvisioningOptions,visibility,createdDateTime").filter("resourceProvisioningOptions/any(x:x eq 'Team')").get()];case 1:if(!(e=n.sent())||!e.value)throw new Error("No group memberships data received");return[2,e.value.map(function(e){return{id:e.id,displayName:e.displayName,description:e.description,resourceBehaviorOptions:e.resourceBehaviorOptions,resourceProvisioningOptions:e.resourceProvisioningOptions,visibility:e.visibility,createdDateTime:e.createdDateTime}})];case 2:throw t=n.sent(),this._handleError(t);case 3:return[2]}})})},e.prototype.getConnectedTeams=function(){return p(this,void 0,void 0,function(){var e,t,n,a,i,r,o,s;return m(this,function(c){switch(c.label){case 0:return c.trys.push([0,8,,9]),[4,this.getUserGroupMemberships()];case 1:e=c.sent(),t=[],n=0,a=e,c.label=2;case 2:if(!(n<a.length))return[3,7];i=a[n],c.label=3;case 3:return c.trys.push([3,5,,6]),[4,this.graphClient.api("/teams/".concat(i.id)).select("id,displayName,description,isArchived").get()];case 4:return r=c.sent(),t.push({id:r.id,displayName:r.displayName,description:r.description,groupId:i.id,isArchived:r.isArchived}),[3,6];case 5:return o=c.sent(),console.warn("Group ".concat(i.displayName," is not a team or access denied:"),o),[3,6];case 6:return n++,[3,2];case 7:if(0===t.length)throw{type:"NO_GROUPS",message:"User is not a member of any teams with SharePoint sites"};return[2,t];case 8:if((s=c.sent()).type)throw s;throw this._handleError(s);case 9:return[2]}})})},e.prototype.getUserFilesInTeams=function(){return p(this,void 0,void 0,function(){var e,t,n,a,i,r,o,s,c,d=this;return m(this,function(l){switch(l.label){case 0:return l.trys.push([0,7,,8]),[4,this.getConnectedTeams()];case 1:return e=l.sent(),t=[],[4,this._getCurrentUser()];case 2:n=l.sent(),a=function(e){var a,r,o,s,c;return m(this,function(l){switch(l.label){case 0:return l.trys.push([0,3,,4]),[4,i.graphClient.api("/groups/".concat(e.groupId,"/drive")).get()];case 1:return(a=l.sent())?[4,i._getAllFilesFromDrive(a.id,"root")]:[2,"continue"];case 2:return r=l.sent(),o=r.filter(function(e){var t,a,i,r,o,s,c,d,l,u,f,p,m=(null===(a=null===(t=e.lastModifiedBy)||void 0===t?void 0:t.user)||void 0===a?void 0:a.displayName)===n.displayName||(null===(r=null===(i=e.lastModifiedBy)||void 0===i?void 0:i.user)||void 0===r?void 0:r.email)===n.mail||(null===(s=null===(o=e.lastModifiedBy)||void 0===o?void 0:o.user)||void 0===s?void 0:s.id)===n.id,_=(null===(d=null===(c=e.createdBy)||void 0===c?void 0:c.user)||void 0===d?void 0:d.displayName)===n.displayName||(null===(u=null===(l=e.createdBy)||void 0===l?void 0:l.user)||void 0===u?void 0:u.email)===n.mail||(null===(p=null===(f=e.createdBy)||void 0===f?void 0:f.user)||void 0===p?void 0:p.id)===n.id;return m||_}),s=o.map(function(t){var n;return{id:t.id,name:t.name,webUrl:t.webUrl,size:t.size,fileType:d._getFileType(t.name),lastModifiedDateTime:t.lastModifiedDateTime,lastModifiedBy:t.lastModifiedBy||t.createdBy,teamId:e.id,teamName:e.displayName,driveId:a.id,itemPath:(null===(n=t.parentReference)||void 0===n?void 0:n.path)||"/"}}),t.push.apply(t,s),[3,4];case 3:return c=l.sent(),console.warn("Failed to get files for team ".concat(e.displayName,":"),c),[3,4];case 4:return[2]}})},i=this,r=0,o=e,l.label=3;case 3:return r<o.length?(s=o[r],[5,a(s)]):[3,6];case 4:l.sent(),l.label=5;case 5:return r++,[3,3];case 6:return[2,t];case 7:throw c=l.sent(),this._handleError(c);case 8:return[2]}})})},e.prototype.getUserPersonalSite=function(){return p(this,void 0,void 0,function(){var e,t;return m(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this._userSite?[2,this._userSite]:[4,this.graphClient.api("/me/drive").select("id,name,webUrl").get()];case 1:if(!(e=n.sent()))throw{type:"NO_SITE",message:"Unable to access user personal SharePoint site"};return this._userSite={id:e.id,displayName:e.name||"My Site",webUrl:e.webUrl},[2,this._userSite];case 2:throw t=n.sent(),this._handleError(t);case 3:return[2]}})})},e.prototype.syncFilesToUserSite=function(){return p(this,void 0,void 0,function(){var e,t,n,a,i,r,o,s,c,d,l,u,f,p,_,h,b,g,v,y;return m(this,function(m){switch(m.label){case 0:return m.trys.push([0,25,,26]),this._syncStatus.status="syncing",this._syncStatus.error=void 0,[4,this.getUserPersonalSite()];case 1:return m.sent(),[4,this.getUserFilesInTeams()];case 2:return 0===(e=m.sent()).length?(this._syncStatus.status="idle",[2]):[4,this.graphClient.api("/me/drive").get()];case 3:m.sent(),t="Teams File Sync",n=void 0,m.label=4;case 4:return m.trys.push([4,6,,8]),[4,this.graphClient.api("/me/drive/root:/".concat(t)).get()];case 5:return a=m.sent(),n=a.id,[3,8];case 6:return m.sent(),[4,this.graphClient.api("/me/drive/root/children").post({name:t,folder:{},"@microsoft.graph.conflictBehavior":"replace"})];case 7:return i=m.sent(),n=i.id,[3,8];case 8:r=this._groupFilesByTeam(e),o=0,s=0,c=Object.keys(r),m.label=9;case 9:if(!(s<c.length))return[3,24];d=c[s],l=r[d],m.label=10;case 10:m.trys.push([10,22,,23]),u=void 0,m.label=11;case 11:return m.trys.push([11,13,,15]),[4,this.graphClient.api("/me/drive/items/".concat(n,":/").concat(d)).get()];case 12:return f=m.sent(),u=f.id,[3,15];case 13:return m.sent(),[4,this.graphClient.api("/me/drive/items/".concat(n,"/children")).post({name:d,folder:{},"@microsoft.graph.conflictBehavior":"replace"})];case 14:return p=m.sent(),u=p.id,[3,15];case 15:_=0,h=l,m.label=16;case 16:if(!(_<h.length))return[3,21];b=h[_],m.label=17;case 17:return m.trys.push([17,19,,20]),[4,this._copyFileToUserSite(b,u)];case 18:return m.sent(),o++,[3,20];case 19:return g=m.sent(),console.warn("Failed to copy file ".concat(b.name,":"),g),[3,20];case 20:return _++,[3,16];case 21:return[3,23];case 22:return v=m.sent(),console.warn("Failed to sync files for team ".concat(d,":"),v),[3,23];case 23:return s++,[3,9];case 24:return this._syncStatus={isEnabled:!0,lastSyncDate:new Date,fileCount:o,teamsCount:Object.keys(r).length,status:"idle"},this._saveSyncStatus(),[3,26];case 25:throw y=m.sent(),this._syncStatus.status="error",this._syncStatus.error="Sync failed: "+y.message,this._handleError(y,"SYNC_ERROR");case 26:return[2]}})})},e.prototype.getSyncStatus=function(){return f({},this._syncStatus)},e.prototype.toggleSync=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){switch(t.label){case 0:return this._syncStatus.isEnabled=e,this._saveSyncPreference(e),e?[4,this.syncFilesToUserSite()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.startBackgroundSync=function(){return p(this,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:if(!this._syncStatus.isEnabled)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.syncFilesToUserSite()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),console.error("Background sync failed:",e),[3,4];case 4:return[2]}})})},e.prototype._getCurrentUser=function(){return p(this,void 0,void 0,function(){return m(this,function(e){switch(e.label){case 0:return[4,this.graphClient.api("/me").select("id,displayName,mail,userPrincipalName").get()];case 1:return[2,e.sent()]}})})},e.prototype._getAllFilesFromDrive=function(e,t,n){return void 0===n&&(n=""),p(this,void 0,void 0,function(){var a,i,r,o,s,c,d;return m(this,function(l){switch(l.label){case 0:return l.trys.push([0,7,,8]),[4,this.graphClient.api("/drives/".concat(e,"/items/").concat(t,"/children")).select("id,name,size,webUrl,lastModifiedDateTime,lastModifiedBy,createdBy,parentReference,file,folder").expand("lastModifiedBy($select=user),createdBy($select=user)").get()];case 1:if(!(a=l.sent())||!a.value)return[2,[]];i=[],r=0,o=a.value,l.label=2;case 2:return r<o.length?(s=o[r]).file?(s.parentReference=f(f({},s.parentReference),{path:n}),i.push(s),[3,5]):[3,3]:[3,6];case 3:return s.folder?[4,this._getAllFilesFromDrive(e,s.id,"".concat(n,"/").concat(s.name))]:[3,5];case 4:c=l.sent(),i.push.apply(i,c),l.label=5;case 5:return r++,[3,2];case 6:return[2,i];case 7:return d=l.sent(),console.warn("Failed to get files from drive ".concat(e,", item ").concat(t,":"),d),[2,[]];case 8:return[2]}})})},e.prototype._copyFileToUserSite=function(e,t){return p(this,void 0,void 0,function(){var n,a,i,r,o,s,c;return m(this,function(d){switch(d.label){case 0:return d.trys.push([0,3,,4]),n="/drives/".concat(e.driveId,"/items/").concat(e.id),r=(i=this.graphClient.api("".concat(n,"/copy"))).post,s={},c={},[4,this.graphClient.api("/me/drive").get()];case 1:return[4,r.apply(i,[(s.parentReference=(c.driveId=d.sent().id,c.id=t,c),s.name=e.name,s)])];case 2:return(a=d.sent())&&a.id&&console.log("Successfully copied file: ".concat(e.name)),[3,4];case 3:if("nameAlreadyExists"!==(o=d.sent()).code)throw o;return[3,4];case 4:return[2]}})})},e.prototype._groupFilesByTeam=function(e){return e.reduce(function(e,t){return e[t.teamName]||(e[t.teamName]=[]),e[t.teamName].push(t),e},{})},e.prototype._getFileType=function(e){var t;return{doc:"Word Document",docx:"Word Document",xls:"Excel Spreadsheet",xlsx:"Excel Spreadsheet",ppt:"PowerPoint Presentation",pptx:"PowerPoint Presentation",pdf:"PDF Document",txt:"Text File",jpg:"Image",jpeg:"Image",png:"Image",gif:"Image"}[(null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase())||""]||"File"},e.prototype._getSyncPreference=function(){try{return"true"===localStorage.getItem("teamsFileSyncEnabled")}catch(e){return!1}},e.prototype._saveSyncPreference=function(e){try{localStorage.setItem("teamsFileSyncEnabled",e.toString())}catch(e){console.warn("Failed to save sync preference:",e)}},e.prototype._saveSyncStatus=function(){var e;try{var t={lastSyncDate:null===(e=this._syncStatus.lastSyncDate)||void 0===e?void 0:e.toISOString(),fileCount:this._syncStatus.fileCount,teamsCount:this._syncStatus.teamsCount};localStorage.setItem("teamsFileSyncStatus",JSON.stringify(t))}catch(e){console.warn("Failed to save sync status:",e)}},e.prototype._loadSyncStatus=function(){try{var e=localStorage.getItem("teamsFileSyncStatus");if(e){var t=JSON.parse(e);this._syncStatus.lastSyncDate=t.lastSyncDate?new Date(t.lastSyncDate):void 0,this._syncStatus.fileCount=t.fileCount||0,this._syncStatus.teamsCount=t.teamsCount||0}}catch(e){console.warn("Failed to load sync status:",e)}},e.prototype._handleError=function(e,t){return void 0===t&&(t="UNKNOWN"),console.error("GroupMembership Service Error:",e),"Forbidden"===e.code||403===e.status?{type:"NO_PERMISSIONS",message:"Insufficient permissions to access SharePoint data. Please contact your administrator.",originalError:e}:"NetworkError"===e.code||"NetworkError"===e.name?{type:"NETWORK_ERROR",message:"Network error occurred while fetching data. Please check your connection and try again.",originalError:e}:e.type?e:{type:t,message:"An error occurred: ".concat(e.message||"Unknown error"),originalError:e}},e}(),h=(c=function(e,t){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},c(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),b=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},g=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};const v=function(n){function c(){var e=null!==n&&n.apply(this,arguments)||this;return e._isDarkTheme=!1,e._environmentMessage="",e._clickCount=0,e._groupService=null,e._teams=[],e._userFiles=[],e._syncStatus=null,e._isLoading=!1,e._error="",e._userSiteUrl="",e._backgroundSyncTimer=null,e}return h(c,n),c.prototype.render=function(){this.domElement.innerHTML='\n    <section class="'.concat("helloWorld_044e9f46"," ").concat(this.context.sdks.microsoftTeams?"teams_044e9f46":"",'">\n      <div class="').concat("headerCard_044e9f46",'">\n        <div class="').concat("welcome_044e9f46",'">\n          <img alt="" src="').concat(this._isDarkTheme?d(309):d(141),'" class="').concat("welcomeImage_044e9f46",'" />\n          <h2>Well done, ').concat((0,a.escape)(this.context.pageContext.user.displayName),'!</h2>\n          <div class="').concat("environmentInfo_044e9f46",'">').concat(this._environmentMessage,'</div>\n          <div class="').concat("propertyInfo_044e9f46",'">Web part property: <strong>').concat((0,a.escape)(this.properties.description),'</strong></div>\n        </div>\n      </div>\n\n      <div class="').concat("teamsCard_044e9f46",'">\n        <h3>üìÅ Teams File Sync Manager</h3>\n        <div class="').concat("teamsSection_044e9f46",'">\n          ').concat(this._renderSyncInterface(),'\n        </div>\n      </div>\n\n      <div class="').concat("interactiveCard_044e9f46",'">\n        <h3>üéØ Interactive Test Area</h3>\n        <div class="').concat("counterSection_044e9f46",'">\n          <p>Click counter: <span class="').concat(i,'">').concat(this._clickCount,'</span></p>\n          <button class="').concat(r,'" data-action="increment">Increment Counter</button>\n          <button class="').concat(o,'" data-action="reset">Reset Counter</button>\n        </div>\n      </div>\n\n      <div class="').concat("contentCard_044e9f46",'">\n        <h3>üìö Welcome to SharePoint Framework!</h3>\n        <p class="').concat("description_044e9f46",'">\n        The SharePoint Framework (SPFx) is an extensibility model for Microsoft Viva, Microsoft Teams and SharePoint. It\'s the easiest way to extend Microsoft 365 with automatic Single Sign On, automatic hosting and industry standard tooling.\n        </p>\n        <h4>üöÄ Learn more about SPFx development:</h4>\n          <ul class="').concat("links_044e9f46",'">\n            <li><a href="https://aka.ms/spfx" target="_blank">üìñ SharePoint Framework Overview</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-graph" target="_blank">üìä Use Microsoft Graph in your solution</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-teams" target="_blank">üë• Build for Microsoft Teams using SharePoint Framework</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-viva" target="_blank">üíº Build for Microsoft Viva Connections using SharePoint Framework</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-store" target="_blank">üè™ Publish SharePoint Framework applications to the marketplace</a></li>\n            <li><a href="https://aka.ms/spfx-yeoman-api" target="_blank">üîß SharePoint Framework API reference</a></li>\n            <li><a href="https://aka.ms/m365pnp" target="_blank">ÔøΩü§ù Microsoft 365 Developer Community</a></li>\n          </ul>\n      </div>\n    </section>'),this._bindEvents()},c.prototype._renderSyncInterface=function(){if(this._isLoading)return'\n        <div class="'.concat("loadingState_044e9f46",'">\n          <div class="').concat("spinner_044e9f46",'"></div>\n          <p>Loading sync information...</p>\n        </div>\n      ');if(this._error)return'\n        <div class="'.concat("errorState_044e9f46",'">\n          <p class="').concat(s,'">‚ùå ').concat(this._error,'</p>\n          <button class="').concat(r,'" data-action="retry">Try Again</button>\n        </div>\n      ');if(!this._syncStatus)return'\n        <div class="'.concat("emptyState_044e9f46",'">\n          <button class="').concat(r,'" data-action="initialize-sync">Initialize File Sync</button>\n        </div>\n      ');var e="syncing"===this._syncStatus.status?"üîÑ":"error"===this._syncStatus.status?"‚ùå":this._syncStatus.isEnabled?"‚óè":"‚óã",t=this._syncStatus.isEnabled?"Enabled":"Disabled",n=this._syncStatus.lastSyncDate?this._syncStatus.lastSyncDate.toLocaleString():"Never";return'\n      <div class="'.concat("syncInterface_044e9f46",'">\n        <div class="').concat("syncHeader_044e9f46",'">\n          <div class="').concat("siteInfo_044e9f46",'">\n            <p><strong>Your SharePoint Site:</strong>\n              ').concat(this._userSiteUrl?'<a href="'.concat(this._userSiteUrl,'" target="_blank">').concat(this._userSiteUrl,"</a>"):"Loading...",'\n            </p>\n          </div>\n\n          <div class="').concat("syncStatus_044e9f46",'">\n            <p><strong>Sync Status:</strong> ').concat(e," ").concat(t,"</p>\n            <p><strong>Last Sync:</strong> ").concat(n,"</p>\n            <p><strong>Files Synced:</strong> ").concat(this._syncStatus.fileCount," files from ").concat(this._syncStatus.teamsCount," teams</p>\n            ").concat(this._syncStatus.error?'<p class="'.concat(s,'">Error: ').concat(this._syncStatus.error,"</p>"):"",'\n          </div>\n        </div>\n\n        <div class="').concat("syncControls_044e9f46",'">\n          <button class="').concat(r,'"\n                  data-action="').concat(this._syncStatus.isEnabled?"disable-sync":"enable-sync",'"\n                  ').concat("syncing"===this._syncStatus.status?"disabled":"",">\n            üîÑ ").concat(this._syncStatus.isEnabled?"Disable Sync":"Enable Sync","\n          </button>\n          ").concat(this._syncStatus.isEnabled?'<button class="'.concat(o,'" data-action="view-files">üìÅ View Files</button>'):"","\n        </div>\n\n        ").concat(this._teams.length>0?this._renderTeamsList():"","\n      </div>\n    ")},c.prototype._renderTeamsList=function(){if(0===this._teams.length)return"";for(var e='\n      <div class="'.concat("teamsListContainer_044e9f46",'">\n        <h4>Teams Being Synced:</h4>\n        <div class="').concat("teamsList_044e9f46",'">\n    '),t=function(t){var i=n._userFiles.filter(function(e){return e.teamId===t.id}).length;e+='\n        <div class="'.concat("teamItem_044e9f46",'">\n          <span class="').concat("teamIcon_044e9f46",'">‚úÖ</span>\n          <span class="').concat("teamName_044e9f46",'">').concat((0,a.escape)(t.displayName),'</span>\n          <span class="').concat("fileCount_044e9f46",'">(').concat(i," files where you contributed)</span>\n        </div>\n      ")},n=this,i=0,r=this._teams;i<r.length;i++)t(r[i]);return e+="\n        </div>\n      </div>\n    "},c.prototype._bindEvents=function(){var e=this;this.domElement.addEventListener("click",function(t){var n=t.target.getAttribute("data-action");"increment"===n?(e._clickCount++,e._updateCounter()):"reset"===n?(e._clickCount=0,e._updateCounter()):"initialize-sync"===n?e._initializeSync():"enable-sync"===n?e._toggleSync(!0):"disable-sync"===n?e._toggleSync(!1):"view-files"===n?e._viewSyncedFiles():"retry"===n&&(e._error="",e._initializeSync())})},c.prototype._updateCounter=function(){var e=this.domElement.querySelector(".".concat(i));e&&(e.textContent=this._clickCount.toString())},c.prototype._initializeSync=function(){return b(this,void 0,void 0,function(){var e,t,n,a,i,r;return g(this,function(o){switch(o.label){case 0:this._isLoading=!0,this._error="",this.render(),o.label=1;case 1:return o.trys.push([1,7,,8]),this._groupService?[3,3]:[4,this.context.msGraphClientFactory.getClient("3")];case 2:e=o.sent(),this._groupService=new _(e),o.label=3;case 3:return[4,this._groupService.getUserPersonalSite()];case 4:return t=o.sent(),this._userSiteUrl=t.webUrl,n=this,[4,this._groupService.getConnectedTeams()];case 5:return n._teams=o.sent(),a=this,[4,this._groupService.getUserFilesInTeams()];case 6:return a._userFiles=o.sent(),this._syncStatus=this._groupService.getSyncStatus(),this._isLoading=!1,this.render(),[3,8];case 7:switch(i=o.sent(),this._isLoading=!1,(r=i).type){case"NO_PERMISSIONS":this._error="Insufficient permissions. Please contact your administrator to approve Microsoft Graph permissions.";break;case"NO_GROUPS":this._error="You are not a member of any teams with SharePoint sites.";break;case"NO_SITE":this._error="Unable to access your personal SharePoint site.";break;case"NETWORK_ERROR":this._error="Network error. Please check your connection and try again.";break;default:this._error=r.message||"An unexpected error occurred while initializing sync."}return this.render(),console.error("Error initializing sync:",i),[3,8];case 8:return[2]}})})},c.prototype._toggleSync=function(e){return b(this,void 0,void 0,function(){var t;return g(this,function(n){switch(n.label){case 0:if(!this._groupService)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),this._isLoading=!0,this.render(),[4,this._groupService.toggleSync(e)];case 2:return n.sent(),this._syncStatus=this._groupService.getSyncStatus(),e?this._startBackgroundSync():this._stopBackgroundSync(),this._isLoading=!1,this.render(),[3,4];case 3:return t=n.sent(),this._isLoading=!1,this._error="Failed to ".concat(e?"enable":"disable"," sync: ").concat(t.message),this.render(),console.error("Error toggling sync:",t),[3,4];case 4:return[2]}})})},c.prototype._viewSyncedFiles=function(){if(this._userSiteUrl){var e="".concat(this._userSiteUrl,"/Teams File Sync");window.open(e,"_blank")}},c.prototype._startBackgroundSync=function(){var e=this;this._stopBackgroundSync(),this._backgroundSyncTimer=window.setInterval(function(){return b(e,void 0,void 0,function(){var e,t;return g(this,function(n){switch(n.label){case 0:if(!this._groupService||!(null===(t=this._syncStatus)||void 0===t?void 0:t.isEnabled))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),console.log("Running background sync..."),[4,this._groupService.startBackgroundSync()];case 2:return n.sent(),this._syncStatus=this._groupService.getSyncStatus(),this.render(),[3,4];case 3:return e=n.sent(),console.error("Background sync failed:",e),[3,4];case 4:return[2]}})})},144e5)},c.prototype._stopBackgroundSync=function(){this._backgroundSyncTimer&&(window.clearInterval(this._backgroundSyncTimer),this._backgroundSyncTimer=null)},c.prototype.onInit=function(){var e=this;return this._getEnvironmentMessage().then(function(t){e._environmentMessage=t,e.context.msGraphClientFactory&&e._initializeSync().then(function(){var t;(null===(t=e._syncStatus)||void 0===t?void 0:t.isEnabled)&&e._startBackgroundSync()})})},c.prototype._getEnvironmentMessage=function(){var e=this;return this.context.sdks.microsoftTeams?this.context.sdks.microsoftTeams.teamsJs.app.getContext().then(function(t){var n="";switch(t.app.host.name){case"Office":n=e.context.isServedFromLocalhost?u.AppLocalEnvironmentOffice:u.AppOfficeEnvironment;break;case"Outlook":n=e.context.isServedFromLocalhost?u.AppLocalEnvironmentOutlook:u.AppOutlookEnvironment;break;case"Teams":case"TeamsModern":n=e.context.isServedFromLocalhost?u.AppLocalEnvironmentTeams:u.AppTeamsTabEnvironment;break;default:n=u.UnknownEnvironment}return n}):Promise.resolve(this.context.isServedFromLocalhost?u.AppLocalEnvironmentSharePoint:u.AppSharePointEnvironment)},c.prototype.onThemeChanged=function(e){if(e){this._isDarkTheme=!!e.isInverted;var t=e.semanticColors;t&&(this.domElement.style.setProperty("--bodyText",t.bodyText||null),this.domElement.style.setProperty("--link",t.link||null),this.domElement.style.setProperty("--linkHovered",t.linkHovered||null))}},Object.defineProperty(c.prototype,"dataVersion",{get:function(){return e.Version.parse("1.0")},enumerable:!1,configurable:!0}),c.prototype.onDispose=function(){this._stopBackgroundSync(),n.prototype.onDispose.call(this)},c.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:u.PropertyPaneDescription},groups:[{groupName:u.BasicGroupName,groupFields:[(0,t.PropertyPaneTextField)("description",{label:u.DescriptionFieldLabel})]}]}]}},c}(n.BaseClientSideWebPart)})(),l})())})();